# main.kv
#:kivy 2.1.0

<Root>:
    orientation: "vertical"
    padding: dp(8)
    spacing: dp(8)

    BoxLayout:
        size_hint_y: None
        height: dp(36)
        spacing: dp(6)
        Button:
            text: "üìÅ –®–∞–±–ª–æ–Ω"
            size_hint_x: None
            width: dp(120)
            on_release: root.choose_template()
        Label:
            text: root.template_status
            halign: "left"
            valign: "middle"
            text_size: self.size

    ScrollView:
        size_hint_y: None
        height: dp(140)
        do_scroll_x: False
        TextInput:
            id: brief
            hint_text: "–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–µ–∫—Å—Ç –±—Ä–∏—Ñ–∞"
            multiline: True
            font_size: dp(14)
            on_text: root.parse_brief()

    Spinner:
        id: institution
        text: "–ê–≤—Ç–æ"
        values: ("–ê–≤—Ç–æ","–®–∫–æ–ª–∞","–î–µ—Ç—Å–∫–∏–π —Å–∞–¥","–õ–∏—Ü–µ–π","–ì–∏–º–Ω–∞–∑–∏—è","–ü—Ä–æ–≥–∏–º–Ω–∞–∑–∏—è","–ò–Ω—Ç–µ—Ä–Ω–∞—Ç")
        size_hint_y: None
        height: dp(40)
        on_text: root.parse_brief()

    GridLayout:
        cols: 2
        size_hint_y: None
        row_default_height: dp(40)
        row_force_default: True

        Label: text: "–§–ò–û:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: id: fio; on_text: root.update_preview()

        Label: text: "VK:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: id: vk; on_text: root.update_preview()

        Label: text: "–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: id: prepay; input_filter: "int"; on_text: root.update_preview()

        Label: text: "–°—Ç—Ä–∞–Ω–∏—Ü—ã:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: id: pages; on_text: root.update_preview()

        Label: text: "–ß–∞—Å—ã:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: id: hours; on_text: root.update_preview()

        Label: text: "–î–∞—Ç–∞:"; halign: "right"; valign: "middle"; text_size: self.size
        TextInput: text: root.date_text; on_text: root.update_preview()

    BoxLayout:
        size_hint_y: None
        height: dp(40)
        spacing: dp(8)
        ToggleButton:
            text: "–¶–∏—Ç–∞—Ç—ã"
            state: "down" if root.citata_on else "normal"
            on_state: root.set_citata(self.state == "down")
        Button:
            text: "–°–±—Ä–æ—Å"
            on_release: root.reset_form()

    Label:
        text: "üìÑ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö:"
        size_hint_y: None
        height: dp(24)

    ScrollView:
        size_hint_y: None
        height: dp(180)
        do_scroll_x: False
        Label:
            id: preview
            text: root.preview_html
            markup: True
            font_size: dp(14)
            text_size: self.width, None
            size_hint_y: None
            height: self.texture_size[1]

    Button:
        text: "–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä"
        size_hint_y: None
        height: dp(48)
        on_release: root.generate()

    Label:
        text: "üìã –õ–æ–≥:"
        size_hint_y: None
        height: dp(24)

    ScrollView:
        do_scroll_x: False
        TextInput:
            id: log
            text: root.log_text
            readonly: True
            size_hint_y: None
            height: max(self.minimum_height, dp(120))
